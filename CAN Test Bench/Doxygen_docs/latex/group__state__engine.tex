\hypertarget{group__state__engine}{}\doxysection{State Engine}
\label{group__state__engine}\index{State Engine@{State Engine}}


Module containing all of the functions needed for the vehicle state machine to work.  


\doxysubsection*{Modules}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{group__state__engine__api}{State Engine A\+PI}}
\begin{DoxyCompactList}\small\item\em Provides publically available A\+PI for controlling vehicle state and error handling. \end{DoxyCompactList}\item 
\mbox{\hyperlink{group__state__engine__backend}{State Engine Internals}}
\end{DoxyCompactItemize}
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structstate__change__daemon__args}{state\+\_\+change\+\_\+daemon\+\_\+args}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group__state__engine_ga8a80fe70c2d06583bbcd00c5162860c5}{M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+M\+A\+N\+A\+G\+E\+D\+\_\+\+T\+A\+S\+KS}}~16
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{structstate__change__daemon__args}{state\+\_\+change\+\_\+daemon\+\_\+args}} \mbox{\hyperlink{group__state__engine_gac9bd88d7c454ec151183930fce544c9c}{state\+\_\+change\+\_\+daemon\+\_\+args}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{group__state__engine_gaff684308203d45e9e16ad3d115c54279}{uv\+S\+V\+C\+Task\+Manager}} (void $\ast$args)
\begin{DoxyCompactList}\small\item\em oversees all of the service tasks, and makes sure that theyre alright \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{uvfr__state__engine_8h_aa6ffd72eb4909ddb38c37a1369e13f09}{uv\+\_\+task\+\_\+id}} \mbox{\hyperlink{group__state__engine_gaf070a24ce066297b4a8276ddcb884b0c}{\+\_\+next\+\_\+task\+\_\+id}} = 0
\item 
static \mbox{\hyperlink{structuv__task__info}{uv\+\_\+task\+\_\+info}} $\ast$ \mbox{\hyperlink{group__state__engine_ga6b49ab568bed9d9189782eebb90545b5}{\+\_\+task\+\_\+register}} = N\+U\+LL
\item 
static \mbox{\hyperlink{uvfr__state__engine_8h_aa6ffd72eb4909ddb38c37a1369e13f09}{uv\+\_\+task\+\_\+id}} \mbox{\hyperlink{group__state__engine_gae48b13e362d2b9d10ec61f516ea5c09f}{\+\_\+next\+\_\+svc\+\_\+task\+\_\+id}} = 0
\item 
static \mbox{\hyperlink{structuv__task__info}{uv\+\_\+task\+\_\+info}} $\ast$ \mbox{\hyperlink{group__state__engine_ga031bbb86895e7346f4c7c168b36ffbd4}{\+\_\+svc\+\_\+task\+\_\+register}} = N\+U\+LL
\item 
Task\+Handle\+\_\+t $\ast$ \mbox{\hyperlink{group__state__engine_gac204f3b14ce9bf370b2e5477dc87afea}{scd\+\_\+handle\+\_\+ptr}}
\item 
static volatile \mbox{\hyperlink{uvfr__utils_8h_a0ecf26b576b9a54eca656b9be7ba6a06}{bool}} \mbox{\hyperlink{group__state__engine_gaa11ee7595fe2da14c5949195824179af}{S\+C\+D\+\_\+active}} = \mbox{\hyperlink{group__utility__macros_ga65e9886d74aaee76545e83dd09011727}{false}}
\item 
static Queue\+Handle\+\_\+t \mbox{\hyperlink{group__state__engine_ga6837d935e61f84062544da8971a18560}{state\+\_\+change\+\_\+queue}} = N\+U\+LL
\item 
\mbox{\hyperlink{structrbtree}{rbtree}} $\ast$ \mbox{\hyperlink{group__state__engine_ga168524a5d658247db44217e643b6396f}{task\+\_\+name\+\_\+lut}} = N\+U\+LL
\item 
enum \mbox{\hyperlink{group__state__engine__api_ga259abff5a03eaf908dc8f03d99f478e4}{uv\+\_\+vehicle\+\_\+state\+\_\+t}} \mbox{\hyperlink{group__state__engine_ga2f58cf65b3566bc390600f877f8bed35}{vehicle\+\_\+state}} = \mbox{\hyperlink{group__state__engine__api_gga259abff5a03eaf908dc8f03d99f478e4afdfc4cdb8c5210e05bdfdc3df51f80ff}{U\+V\+\_\+\+B\+O\+OT}}
\item 
enum \mbox{\hyperlink{group__state__engine__api_ga259abff5a03eaf908dc8f03d99f478e4}{uv\+\_\+vehicle\+\_\+state\+\_\+t}} \mbox{\hyperlink{group__state__engine_ga2ce6eef16a78c095592954d2fe68af2e}{previous\+\_\+state}} = \mbox{\hyperlink{group__state__engine__api_gga259abff5a03eaf908dc8f03d99f478e4afdfc4cdb8c5210e05bdfdc3df51f80ff}{U\+V\+\_\+\+B\+O\+OT}}
\item 
\mbox{\hyperlink{structuv__task__info}{uv\+\_\+task\+\_\+info}} $\ast$ \mbox{\hyperlink{group__state__engine_ga3de41676729241e58688c61c450e4a1e}{task\+\_\+manager}} = N\+U\+LL
\item 
\mbox{\hyperlink{structuv__task__info}{uv\+\_\+task\+\_\+info}} $\ast$ \mbox{\hyperlink{group__state__engine_ga42329069c59ef55a97a6b0bca0cafd32}{svc\+\_\+task\+\_\+manager}} = N\+U\+LL
\item 
\mbox{\hyperlink{structuv__os__settings}{uv\+\_\+os\+\_\+settings}} \mbox{\hyperlink{group__state__engine_gad9e02be6d2d0bc1ab5cd9fd8cae34230}{default\+\_\+os\+\_\+settings}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Module containing all of the functions needed for the vehicle state machine to work. 

The state-\/engine is mission critical code for doing the following\+:
\begin{DoxyItemize}
\item Providing a state machine for the vehicle
\item Providing infrastructure neccessary for the vehicle to change state, and behaving as a parent to all the R\+T\+OS tasks
\item Providing an A\+PI to hide the nitty-\/gritty of interfacing with the operating system, mitigating race conditions, etc... 
\end{DoxyItemize}

\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{group__state__engine_ga8a80fe70c2d06583bbcd00c5162860c5}\label{group__state__engine_ga8a80fe70c2d06583bbcd00c5162860c5}} 
\index{State Engine@{State Engine}!MAX\_NUM\_MANAGED\_TASKS@{MAX\_NUM\_MANAGED\_TASKS}}
\index{MAX\_NUM\_MANAGED\_TASKS@{MAX\_NUM\_MANAGED\_TASKS}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{MAX\_NUM\_MANAGED\_TASKS}{MAX\_NUM\_MANAGED\_TASKS}}
{\footnotesize\ttfamily \#define M\+A\+X\+\_\+\+N\+U\+M\+\_\+\+M\+A\+N\+A\+G\+E\+D\+\_\+\+T\+A\+S\+KS~16}



Definition at line 20 of file uvfr\+\_\+state\+\_\+engine.\+c.



\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{group__state__engine_gac9bd88d7c454ec151183930fce544c9c}\label{group__state__engine_gac9bd88d7c454ec151183930fce544c9c}} 
\index{State Engine@{State Engine}!state\_change\_daemon\_args@{state\_change\_daemon\_args}}
\index{state\_change\_daemon\_args@{state\_change\_daemon\_args}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{state\_change\_daemon\_args}{state\_change\_daemon\_args}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structstate__change__daemon__args}{state\+\_\+change\+\_\+daemon\+\_\+args}} \mbox{\hyperlink{structstate__change__daemon__args}{state\+\_\+change\+\_\+daemon\+\_\+args}}}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{group__state__engine_gaff684308203d45e9e16ad3d115c54279}\label{group__state__engine_gaff684308203d45e9e16ad3d115c54279}} 
\index{State Engine@{State Engine}!uvSVCTaskManager@{uvSVCTaskManager}}
\index{uvSVCTaskManager@{uvSVCTaskManager}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{uvSVCTaskManager()}{uvSVCTaskManager()}}
{\footnotesize\ttfamily void uv\+S\+V\+C\+Task\+Manager (\begin{DoxyParamCaption}\item[{void $\ast$}]{args }\end{DoxyParamCaption})}



oversees all of the service tasks, and makes sure that theyre alright 

Start all of the service tasks. This involves allocating neccessary memory, setting the appropriate task parameters, and saying \char`\"{}fuck it we ball\char`\"{} and adding the tasks to the central task tracking data structure.

Now we deinitialize the svc\+Task\+Manager. This is done by doing the following\+:
\begin{DoxyItemize}
\item actually shut down the svc tasks
\item double check that the tasks have acually shut down
\item if any svc tasks are resisting nature\textquotesingle{}s call, they will be shut down forcibly
\item deallocate data structures specific to {\ttfamily uv\+S\+V\+C\+Task\+Manager} 
\end{DoxyItemize}

Lovely times for all

Definition at line 1284 of file uvfr\+\_\+state\+\_\+engine.\+c.



References \+\_\+\+\_\+uv\+Init\+Panic(), \+\_\+task\+\_\+register, uv\+\_\+task\+\_\+info\+::active\+\_\+states, C\+A\+N\+\_\+\+T\+X\+\_\+\+D\+A\+E\+M\+O\+N\+\_\+\+N\+A\+ME, C\+A\+Nbus\+Tx\+Svc\+Daemon(), uv\+\_\+task\+\_\+info\+::task\+\_\+function, task\+\_\+management\+\_\+info\+::task\+\_\+handle, uv\+\_\+task\+\_\+info\+::task\+\_\+name, uv\+Create\+Service\+Task(), and uv\+Start\+Task().



Referenced by uv\+Start\+State\+Machine().



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{group__state__engine_gae48b13e362d2b9d10ec61f516ea5c09f}\label{group__state__engine_gae48b13e362d2b9d10ec61f516ea5c09f}} 
\index{State Engine@{State Engine}!\_next\_svc\_task\_id@{\_next\_svc\_task\_id}}
\index{\_next\_svc\_task\_id@{\_next\_svc\_task\_id}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{\_next\_svc\_task\_id}{\_next\_svc\_task\_id}}
{\footnotesize\ttfamily \mbox{\hyperlink{uvfr__state__engine_8h_aa6ffd72eb4909ddb38c37a1369e13f09}{uv\+\_\+task\+\_\+id}} \+\_\+next\+\_\+svc\+\_\+task\+\_\+id = 0\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 28 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by uv\+Create\+Service\+Task().

\mbox{\Hypertarget{group__state__engine_gaf070a24ce066297b4a8276ddcb884b0c}\label{group__state__engine_gaf070a24ce066297b4a8276ddcb884b0c}} 
\index{State Engine@{State Engine}!\_next\_task\_id@{\_next\_task\_id}}
\index{\_next\_task\_id@{\_next\_task\_id}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{\_next\_task\_id}{\_next\_task\_id}}
{\footnotesize\ttfamily \mbox{\hyperlink{uvfr__state__engine_8h_aa6ffd72eb4909ddb38c37a1369e13f09}{uv\+\_\+task\+\_\+id}} \+\_\+next\+\_\+task\+\_\+id = 0\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 25 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by \+\_\+state\+Change\+Daemon(), kill\+Em\+All(), uv\+Create\+Service\+Task(), uv\+Create\+Task(), and uv\+Validate\+Managed\+Tasks().

\mbox{\Hypertarget{group__state__engine_ga031bbb86895e7346f4c7c168b36ffbd4}\label{group__state__engine_ga031bbb86895e7346f4c7c168b36ffbd4}} 
\index{State Engine@{State Engine}!\_svc\_task\_register@{\_svc\_task\_register}}
\index{\_svc\_task\_register@{\_svc\_task\_register}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{\_svc\_task\_register}{\_svc\_task\_register}}
{\footnotesize\ttfamily \mbox{\hyperlink{structuv__task__info}{uv\+\_\+task\+\_\+info}}$\ast$ \+\_\+svc\+\_\+task\+\_\+register = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 29 of file uvfr\+\_\+state\+\_\+engine.\+c.

\mbox{\Hypertarget{group__state__engine_ga6b49ab568bed9d9189782eebb90545b5}\label{group__state__engine_ga6b49ab568bed9d9189782eebb90545b5}} 
\index{State Engine@{State Engine}!\_task\_register@{\_task\_register}}
\index{\_task\_register@{\_task\_register}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{\_task\_register}{\_task\_register}}
{\footnotesize\ttfamily \mbox{\hyperlink{structuv__task__info}{uv\+\_\+task\+\_\+info}}$\ast$ \+\_\+task\+\_\+register = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 26 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by \+\_\+state\+Change\+Daemon(), \+\_\+uv\+Validate\+Specific\+Task(), kill\+Em\+All(), proccess\+S\+C\+D\+Msg(), uv\+Create\+Service\+Task(), uv\+Create\+Task(), uv\+Init\+State\+Engine(), and uv\+S\+V\+C\+Task\+Manager().

\mbox{\Hypertarget{group__state__engine_gad9e02be6d2d0bc1ab5cd9fd8cae34230}\label{group__state__engine_gad9e02be6d2d0bc1ab5cd9fd8cae34230}} 
\index{State Engine@{State Engine}!default\_os\_settings@{default\_os\_settings}}
\index{default\_os\_settings@{default\_os\_settings}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{default\_os\_settings}{default\_os\_settings}}
{\footnotesize\ttfamily \mbox{\hyperlink{structuv__os__settings}{uv\+\_\+os\+\_\+settings}} default\+\_\+os\+\_\+settings}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{=\{}
\DoxyCodeLine{        .svc\_task\_manager\_period = 50,}
\DoxyCodeLine{        .task\_manager\_period = 50,}
\DoxyCodeLine{        .max\_svc\_task\_period = 250,}
\DoxyCodeLine{        .max\_task\_period = 500,}
\DoxyCodeLine{}
\DoxyCodeLine{\}}

\end{DoxyCode}


Definition at line 45 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by setup\+Default\+Settings().

\mbox{\Hypertarget{group__state__engine_ga2ce6eef16a78c095592954d2fe68af2e}\label{group__state__engine_ga2ce6eef16a78c095592954d2fe68af2e}} 
\index{State Engine@{State Engine}!previous\_state@{previous\_state}}
\index{previous\_state@{previous\_state}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{previous\_state}{previous\_state}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{group__state__engine__api_ga259abff5a03eaf908dc8f03d99f478e4}{uv\+\_\+vehicle\+\_\+state\+\_\+t}} previous\+\_\+state = \mbox{\hyperlink{group__state__engine__api_gga259abff5a03eaf908dc8f03d99f478e4afdfc4cdb8c5210e05bdfdc3df51f80ff}{U\+V\+\_\+\+B\+O\+OT}}}



Definition at line 40 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by change\+Vehicle\+State(), and uv\+Start\+State\+Machine().

\mbox{\Hypertarget{group__state__engine_gaa11ee7595fe2da14c5949195824179af}\label{group__state__engine_gaa11ee7595fe2da14c5949195824179af}} 
\index{State Engine@{State Engine}!SCD\_active@{SCD\_active}}
\index{SCD\_active@{SCD\_active}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{SCD\_active}{SCD\_active}}
{\footnotesize\ttfamily volatile \mbox{\hyperlink{uvfr__utils_8h_a0ecf26b576b9a54eca656b9be7ba6a06}{bool}} S\+C\+D\+\_\+active = \mbox{\hyperlink{group__utility__macros_ga65e9886d74aaee76545e83dd09011727}{false}}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 34 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by \+\_\+state\+Change\+Daemon().

\mbox{\Hypertarget{group__state__engine_gac204f3b14ce9bf370b2e5477dc87afea}\label{group__state__engine_gac204f3b14ce9bf370b2e5477dc87afea}} 
\index{State Engine@{State Engine}!scd\_handle\_ptr@{scd\_handle\_ptr}}
\index{scd\_handle\_ptr@{scd\_handle\_ptr}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{scd\_handle\_ptr}{scd\_handle\_ptr}}
{\footnotesize\ttfamily Task\+Handle\+\_\+t$\ast$ scd\+\_\+handle\+\_\+ptr}



Definition at line 31 of file uvfr\+\_\+state\+\_\+engine.\+c.

\mbox{\Hypertarget{group__state__engine_ga6837d935e61f84062544da8971a18560}\label{group__state__engine_ga6837d935e61f84062544da8971a18560}} 
\index{State Engine@{State Engine}!state\_change\_queue@{state\_change\_queue}}
\index{state\_change\_queue@{state\_change\_queue}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{state\_change\_queue}{state\_change\_queue}}
{\footnotesize\ttfamily Queue\+Handle\+\_\+t state\+\_\+change\+\_\+queue = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 35 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by \+\_\+state\+Change\+Daemon(), kill\+Self(), and suspend\+Self().

\mbox{\Hypertarget{group__state__engine_ga42329069c59ef55a97a6b0bca0cafd32}\label{group__state__engine_ga42329069c59ef55a97a6b0bca0cafd32}} 
\index{State Engine@{State Engine}!svc\_task\_manager@{svc\_task\_manager}}
\index{svc\_task\_manager@{svc\_task\_manager}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{svc\_task\_manager}{svc\_task\_manager}}
{\footnotesize\ttfamily \mbox{\hyperlink{structuv__task__info}{uv\+\_\+task\+\_\+info}}$\ast$ svc\+\_\+task\+\_\+manager = N\+U\+LL}



Definition at line 43 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by uv\+Init\+State\+Engine(), and uv\+Start\+State\+Machine().

\mbox{\Hypertarget{group__state__engine_ga3de41676729241e58688c61c450e4a1e}\label{group__state__engine_ga3de41676729241e58688c61c450e4a1e}} 
\index{State Engine@{State Engine}!task\_manager@{task\_manager}}
\index{task\_manager@{task\_manager}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{task\_manager}{task\_manager}}
{\footnotesize\ttfamily \mbox{\hyperlink{structuv__task__info}{uv\+\_\+task\+\_\+info}}$\ast$ task\+\_\+manager = N\+U\+LL}



Definition at line 42 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by uv\+Init\+State\+Engine(), and uv\+Start\+State\+Machine().

\mbox{\Hypertarget{group__state__engine_ga168524a5d658247db44217e643b6396f}\label{group__state__engine_ga168524a5d658247db44217e643b6396f}} 
\index{State Engine@{State Engine}!task\_name\_lut@{task\_name\_lut}}
\index{task\_name\_lut@{task\_name\_lut}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{task\_name\_lut}{task\_name\_lut}}
{\footnotesize\ttfamily \mbox{\hyperlink{structrbtree}{rbtree}}$\ast$ task\+\_\+name\+\_\+lut = N\+U\+LL}



Definition at line 37 of file uvfr\+\_\+state\+\_\+engine.\+c.

\mbox{\Hypertarget{group__state__engine_ga2f58cf65b3566bc390600f877f8bed35}\label{group__state__engine_ga2f58cf65b3566bc390600f877f8bed35}} 
\index{State Engine@{State Engine}!vehicle\_state@{vehicle\_state}}
\index{vehicle\_state@{vehicle\_state}!State Engine@{State Engine}}
\doxysubsubsection{\texorpdfstring{vehicle\_state}{vehicle\_state}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{group__state__engine__api_ga259abff5a03eaf908dc8f03d99f478e4}{uv\+\_\+vehicle\+\_\+state\+\_\+t}} vehicle\+\_\+state = \mbox{\hyperlink{group__state__engine__api_gga259abff5a03eaf908dc8f03d99f478e4afdfc4cdb8c5210e05bdfdc3df51f80ff}{U\+V\+\_\+\+B\+O\+OT}}}



Definition at line 39 of file uvfr\+\_\+state\+\_\+engine.\+c.



Referenced by \+\_\+state\+Change\+Daemon(), change\+Vehicle\+State(), daq\+Master\+Task(), and uv\+Start\+State\+Machine().

